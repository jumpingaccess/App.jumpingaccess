<%= form_with model: [:admin, competition], local: true, html: { multipart: true } do |f| %>

  <% if competition.errors.any? %>
    <div class="alert alert-danger">
      <h5>Erreur(s) :</h5>
      <ul>
        <% competition.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>
<ul class="nav nav-tabs" id="GeneralftpS3Tabs" role="tablist">

  <li class="nav-item" role="presentation">
    <button class="nav-link active" id="General-tab" data-bs-toggle="tab" data-bs-target="#General" type="button" role="tab">General</button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link" id="ftp-tab" data-bs-toggle="tab" data-bs-target="#ftp" type="button" role="tab">FTP</button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link" id="s3-tab" data-bs-toggle="tab" data-bs-target="#s3" type="button" role="tab">S3</button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link" id="options-tab" data-bs-toggle="tab" data-bs-target="#options" type="button" role="tab">Options</button>
  </li>
</ul>
<div class="tab-content border border-top-0 p-3 mb-4" id="ftpS3TabsContent">
  <div class="tab-pane fade show active" id="General" role="tabpanel">
    <div class="card mb-4">
        <div class="card-header"><strong>Informations g√©n√©rales</strong></div>
        <div class="card-body">
        <div class="mb-3">
            <%= f.label :name, "Nom du concours" %>
            <%= f.text_field :name, class: "form-control" %>
        </div>

        <div class="mb-3">
            <%= f.label :location, "Lieu" %>
            <%= f.text_field :location, class: "form-control" %>
        </div>

        <div class="row mb-3">
            <div class="col"><%= f.label :start_date %><%= f.date_field :start_date, class: "form-control" %></div>
            <div class="col"><%= f.label :end_date %><%= f.date_field :end_date, class: "form-control" %></div>
        </div>

        <div class="mb-3">
            <%= f.label :timezone, "Fuseau horaire" %>
            <%= f.select :timezone, ActiveSupport::TimeZone.all.map { |tz| ["(UTC#{tz.formatted_offset}) #{tz.tzinfo.name}", tz.tzinfo.name] }, {}, class: "form-select" %>
        </div>

        <div class="mb-3">
            <%= f.label :country, "Pays" %>
            <%= f.select :country, country_options, { selected: competition.country }, class: "form-select" %>
        </div>
        <div class="mb-3">
          <%= f.label :provider, "Syst√®me de chronom√©trage", class: "form-label" %>
          <%= f.select :provider,
            options_for_select([["Equipe", "equipe"], ["Hippodata", "hippodata"]], selected: competition.provider),
            { include_blank: "Choisir un fournisseur" },
            class: "form-select" %>
        </div>
        <div class="mb-3">
          <%= f.label :provider_competition_id, "Num√©ro du concours Equipe / Hippodata" %>
          <%= f.text_field :provider_competition_id, class: "form-control" %>
        </div>
        <div class="mb-3">
            <%= f.label :fei_id, "FEI ID" %>
            <%= f.text_field :fei_id, class: "form-control" %>
        </div>

        <div class="mb-3">
            <%= f.label :logo, "Logo du concours" %>
            <%= f.file_field :logo, class: "form-control" %>
            <% if competition.logo.attached? %>
            <div class="mt-2">
                <%= image_tag competition.logo.variant(resize_to_fit: [120, 120]), class: "img-thumbnail" %>
            </div>
            <% end %>
        </div>
        </div>
    </div>
  </div>
  <div class="tab-pane fade" id="ftp" role="tabpanel">
    <div class="card mb-4">
        <div class="card-header"><strong>Configuration FTP</strong></div>
        <div class="card-body">
        <div class="form-check form-switch mb-2">
            <%= f.check_box :ftp_enabled, class: "form-check-input" %>
            <%= f.label :ftp_enabled, "Activer FTP", class: "form-check-label" %>
        </div>

        <div class="row mb-3">
            <div class="col"><%= f.label :ftp_host %><%= f.text_field :ftp_host, class: "form-control" %></div>
            <div class="col"><%= f.label :ftp_port %><%= f.number_field :ftp_port, class: "form-control" %></div>
        </div>

        <div class="row mb-3">
            <div class="col"><%= f.label :ftp_user %><%= f.text_field :ftp_user, class: "form-control" %></div>
            <div class="col"><%= f.label :ftp_password %><%= f.password_field :ftp_password, class: "form-control" %></div>
        </div>

        <div class="mb-3">
            <%= f.label :ftp_path, "Chemin distant" %>
            <%= f.text_field :ftp_path, class: "form-control" %>
        </div>
        </div>
    </div>
  </div>
  <div class="tab-pane fade" id="s3" role="tabpanel">
    <div class="card mb-4">
        <div class="card-header"><strong>Configuration S3</strong></div>
        <div class="card-body">
        <div class="form-check form-switch mb-2">
            <%= f.check_box :s3_enabled, class: "form-check-input" %>
            <%= f.label :s3_enabled, "Activer S3", class: "form-check-label" %>
        </div>

        <div class="mb-3">
            <%= f.label :s3_bucket %><%= f.text_field :s3_bucket, class: "form-control" %>
        </div>
        <div class="mb-3">
            <%= f.label :s3_region %><%= f.text_field :s3_region, class: "form-control" %>
        </div>
        <div class="mb-3">
            <%= f.label :s3_access_key %><%= f.text_field :s3_access_key, class: "form-control" %>
        </div>
        <div class="mb-3">
            <%= f.label :s3_secret_key %><%= f.password_field :s3_secret_key, class: "form-control" %>
        </div>
        </div>
    </div>
  </div>
  <div class="tab-pane fade" id="options" role="tabpanel">
    <!-- üì¶ Options -->
    <div class="card mb-4">
      <div class="card-header"><strong>Activation</strong></div>
      <div class="card-body">
        <div class="form-check form-switch mb-3">
          <%= f.check_box :public_enabled, class: "form-check-input" %>
          <%= f.label :public_enabled, "Afficher sur la page publique", class: "form-check-label" %>
        </div>

        <div class="form-check form-switch mb-3">
          <%= f.check_box :rabbitmq_enabled, class: "form-check-input" %>
          <%= f.label :rabbitmq_enabled, "Envoyer vers RabbitMQ", class: "form-check-label" %>
        </div>
        <div class="form-check form-switch mb-3">
          <%= f.check_box :ffmpeg_quere_enabled, class: "form-check-input" %>
          <%= f.label :ffmpeg_quere_enabled, "Activer l'enregistrement FFMPEG automatique", class: "form-check-label" %>
        </div>
      </div>
    </div>
  </div>
</div>
  <%= f.submit competition.persisted? ? "Mettre √† jour" : "Cr√©er le concours", class: "btn btn-success mb-4" %>

<% end %>
